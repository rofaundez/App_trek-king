<ion-header class="header-container">
  <div class="user-welcome">
    <ion-avatar (click)="goToProfile()" class="imagen_usuario">
      <img [src]="userPhoto">
    </ion-avatar>
    <div class="welcome-text">
      <h2>Bienvenido!</h2>
      <h3>{{userName || "no hay usuario"}} {{userLastName || ""}}</h3>
    </div>
  </div>
</ion-header>

<ion-content class="sos-content">
  <div class="sos-overlay"></div>

  <div class="sos-container">
    <div class="sos-section">
      <h2 class="sos-title">Emergencia</h2>
      <p class="sos-description">Selecciona una opción para solicitar ayuda</p>

      <!-- Botón con popup -->
      <button class="sos-button" (click)="mostrarPopup()">SOS - Avisar a autoridades</button>

      <!-- Botón para grupo -->
      <button class="group-button" (click)="avisarGrupo()">Avisar a mi grupo</button>
    </div>

    <div class="sos-info">
      <h3 class="sos-subtitle">¿Cuándo usar el botón SOS?</h3>
      <ul class="sos-lista">
        <li>En caso de accidente o pérdida.</li>
        <li>Si no puedes seguir caminando.</li>
        <li>Cuando haya una amenaza en la ruta.</li>
      </ul>
    </div>

    <!-- POPUP de cuenta regresiva y opciones -->
    <div *ngIf="popupVisible" class="sos-popup">
      <h3>¿Estás seguro de activar el SOS?</h3>
      <div class="timer">{{ cuentaRegresiva }}</div>

      <p class="mensaje">Selecciona una situación de emergencia:</p>
      <ion-list class="sos-options">
        <ion-item
          button
          *ngFor="let mensaje of mensajesEmergencia"
          (click)="seleccionarMensaje(mensaje)"
          [class.selected]="mensaje === mensajeSeleccionado"
        >
          <ion-label>{{ mensaje }}</ion-label>
        </ion-item>
      </ion-list>

      <p *ngIf="mensajeSeleccionado" class="sos-instruccion">
        <strong>Instrucciones:</strong><br />
        {{ obtenerInstruccion(mensajeSeleccionado) }}
      </p>

      <ion-button expand="block" color="danger" (click)="cancelarSOS()">Cancelar</ion-button>

      <div class="sos-warning">
        ⚠️ Usar este botón solo en emergencias reales. El mal uso puede tener consecuencias legales.
      </div>
    </div>

    <div class="sos-info">
      <h3 class="sos-subtitle">¿Qué hacer mientras esperas?</h3>
      <ul class="sos-lista">
        <li>Busca un lugar seguro.</li>
        <li>Permanece visible y tranquilo.</li>
        <li>Haz ruido si ves o escuchas personas para que te ubiquen más fácilmente.</li>
      </ul>
    </div>
  </div>
</ion-content>

<app-footer></app-footer>
